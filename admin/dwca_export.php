<?php
/* This file will take a series of catalogNumbers from the Occurrence Table and export the data 
from Occurrences, Images, Identifications, and MeasurementOrFact tables
to individual CSV files which will then be zipped into a Darwin Core Archive (DwC-A) file 
that can be imported by other natural history collections or aggregator sites

DwC-A Exporter version 1.0
by Robert Pace <robertpace@robert-pace.com>
*/

//general includes necessary for MySQL access, Global PHP variables, and formatting of all output
include("connect.php");
include("common.php");
include("header.php");

//define a query which will provide the specific rows to be exported to the DwC-a file.
//$query = "SELECT * FROM occurrences";
$query = "SELECT * FROM occurrences WHERE catalogNumber IN ('31234100623543', '31234100623774', '31234100623782', '31234100623790', '31234100623808', '31234100623816', '31234100623824', '31234100623832', '31234100624004', '31234100624095', '31234100624640', '31234100624715', '31234100625233', '31234100625332', '31234100625381', '31234100625399', '31234100625480', '31234100625563', '31234100625571', '31234100625605', '31234100625654', '31234100625712', '31234100625779', '31234100625951', '31234100626009', '31234100626371', '31234100626397', '31234100626439', '31234100626447', '31234100626454', '31234100626603', '31234100626611', '31234100626629', '31234100626736', '31234100627676', '31234100627692', '31234100627718', '31234100627726', '31234100627825', '31234100628138', '31234100628393', '31234100628401', '31234100628427', '31234100628435', '31234100628468', '31234100628559', '31234100628732', '31234100628740', '31234100628757', '31234100629193', '31234100629201', '31234100629250', '31234100629268', '31234100629482', '31234100629870', '31234100629920', '31234100629938', '31234100630035', '31234100630332', '31234100630654', '31234100630662', '31234100630787', '31234100630795', '31234100630951', '31234100631066', '31234100631074', '31234100631280', '31234100631355', '31234100631405', '31234100631447', '31234100631496', '31234100631520', '31234100631538', '31234100632346', '31234100632361', '31234100632445', '31234100632452', '31234100632676', '31234100632825', '31234100632965', '31234100632973', '31234100632981', '31234100633112', '31234100633302', '31234100633492', '31234100633526', '31234100633617', '31234100633625', '31234100633666', '31234100633690', '31234100633708', '31234100633773', '31234100633864', '31234100633914', '31234100634110', '31234100634334', '31234100634417', '31234100634714', '31234100634854', '31234100634904', '31234100634920', '31234100634987', '31234100635299', '31234100635349', '31234100635356', '31234100635554', '31234100635737', '31234100635745', '31234100635901', '31234100636180', '31234100636438', '31234100636537', '31234100636586', '31234100636750', '31234100636826', '31234100636834', '31234100637139', '31234100637147', '31234100637154', '31234100637196', '31234100637337', '31234100637352', '31234100637451', '31234100637477', '31234100637485', '31234100637493', '31234100637501', '31234100637519', '31234100637527', '31234100637550', '31234100637758', '31234100637808', '31234100637915', '31234100637964', '31234100638111', '31234100638343', '31234100638350', '31234100638376', '31234100638418', '31234100638566', '31234100638665', '31234100639010', '31234100639028', '31234100639044', '31234100639077', '31234100639093', '31234100639226', '31234100639309', '31234100639499', '31234100639747', '31234100640406', '31234100640422', '31234100640430', '31234100640455', '31234100640463', '31234100640521', '31234100640711', '31234100640745', '31234100641016', '31234100641024', '31234100641230', '31234100641255', '31234100641412', '31234100641487', '31234100641560', '31234100641578', '31234100641628', '31234100641636', '31234100641693', '31234100641701', '31234100641768', '31234100641859', '31234100642139', '31234100642246', '31234100642394', '31234100642436', '31234100642527', '31234100642790', '31234100643095', '31234100643178', '31234100643384', '31234100643392', '31234100643467', '31234100643731', '31234100643780', '31234100643871', '31234100643897', '31234100643905', '31234100643913', '31234100643921', '31234100643939', '31234100643954', '31234100644218', '31234100644242', '31234100644598', '31234100644689', '31234100644721', '31234100645579', '31234100645652', '31234100645678', '31234100645769', '31234100645777', '31234100645785', '31234100645835', '31234100645843', '31234100645900', '31234100645942', '31234100646205', '31234100646239', '31234100646262', '31234100650439', '31234100650454', '31234100650462', '31234100650595', '31234100650819', '31234100650926', '31234100650934', '31234100650991', '31234100651064', '31234100651288', '31234100651304', '31234100651510', '31234100651528', '31234100651619', '31234100651676', '31234100651841', '31234100651916', '31234100651981', '31234100652005', '31234100652120', '31234100652310', '31234100652724', '31234100652914', '31234100652997', '31234100653011', '31234100653037', '31234100653136', '31234100653201', '31234100653326', '31234100653342', '31234100653458', '31234100653722', '31234100653789', '31234100653797', '31234100653920', '31234100654001', '31234100654076', '31234100654100', '31234100654118', '31234100654381', '31234100654449', '31234100654498', '31234100654688', '31234100654803', '31234100654811', '31234100654837', '31234100655131', '31234100655396', '31234100655412', '31234100655438', '31234100655446', '31234100655453', '31234100655552', '31234100656113', '31234100656246', '31234100656253', '31234100656303', '31234100656386', '31234100656436', '31234100656444', '31234100656451', '31234100656477', '31234100656626', '31234100656634', '31234100656667', '31234100656808', '31234100656899', '31234100657210', '31234100657244', '31234100657509', '31234100658242', '31234100658325', '31234100659125', '31234100659471', '31234100659513', '31234100659612', '31234100659695', '31234100659737', '31234100659794', '31234100659968', '31234100660412', '31234100660420', '31234100660636', '31234100660644', '31234100660826', '31234100660966', '31234100661170', '31234100661253', '31234100661394', '31234100661709', '31234100661832', '31234100661964', '31234100661980', '31234100662277', '31234100662897', '31234100663135', '31234100663440', '31234100663507', '31234100663515', '31234100663523', '31234100663531', '31234100663556', '31234100663564', '31234100663572', '31234100663580', '31234100663598', '31234100663606', '31234100663614', '31234100663622', '31234100663630', '31234100663648', '31234100663655', '31234100663663', '31234100663671', '31234100663689', '31234100663697', '31234100663705', '31234100663713', '31234100663721', '31234100663739', '31234100663747', '31234100663754', '31234100663762', '31234100663770', '31234100663903', '31234100664067', '31234100664075', '31234100664091', '31234100664562', '31234100664711', '31234100664802', '31234100664901', '31234100665049', '31234100665163', '31234100665312', '31234100665361', '31234100665379', '31234100665668', '31234100665692', '31234100665890', '31234100665940', '31234100666039', '31234100666732', '31234100666740', '31234100666815', '31234100666823', '31234100666864', '31234100667011', '31234100667169', '31234100667524', '31234100667581', '31234100667912', '31234100668175', '31234100668290', '31234100668332', '31234100668415', '31234100668878', '31234100668951', '31234100669256', '31234100669355', '31234100669405', '31234100669439', '31234100669462', '31234100669579', '31234100669652', '31234100669892', '31234100670080', '31234100670437', '31234100670502', '31234100670767', '31234100671336', '31234100671344', '31234100671351', '31234100671369', '31234100671575', '31234100671849', '31234100671906', '31234100672011', '31234100672045', '31234100672276', '31234100672490', '31234100672524', '31234100672623', '31234100672722', '31234100672755', '31234100672854', '31234100673233', '31234100673241', '31234100673506', '31234100673829', '31234100674553', '31234100674629', '31234100674637', '31234100674645', '31234100674652', '31234100674686', '31234100675014', '31234100675139', '31234100675170', '31234100675303', '31234100675378', '31234100675550', '31234100675568', '31234100675576', '31234100675592', '31234100675600', '31234100675618', '31234100675626', '31234100675634', '31234100675642', '31234100675659', '31234100675667', '31234100675709', '31234100675717', '31234100675725', '31234100675733', '31234100675758', '31234100675766', '31234100675774', '31234100675782', '31234100675790', '31234100675808', '31234100675832', '31234100675840', '31234100675857', '31234100675881', '31234100675899', '31234100675907', '31234100675915', '31234100675923', '31234100675931', '31234100675956', '31234100675964', '31234100675972', '31234100675980', '31234100675998', '31234100676004', '31234100676012', '31234100676020', '31234100676038', '31234100676046', '31234100676053', '31234100676061', '31234100676079', '31234100676087', '31234100676095', '31234100676111', '31234100676129', '31234100676137', '31234100676152', '31234100676160', '31234100676178', '31234100676186', '31234100676194', '31234100676202', '31234100676210', '31234100676228', '31234100676244', '31234100676251', '31234100676269', '31234100676277', '31234100676285', '31234100676301', '31234100676319', '31234100676327', '31234100676343', '31234100676350', '31234100676368', '31234100676376', '31234100676384', '31234100676400', '31234100676418', '31234100676426', '31234100676434', '31234100676442', '31234100676459', '31234100676467', '31234100676491', '31234100676509', '31234100676517', '31234100677234', '31234100677267', '31234100677291', '31234100678265', '31234100678273', '31234100678307', '31234100678315', '31234100678323', '31234100678331', '31234100678349', '31234100678356', '31234100678364', '31234100678372', '31234100678398', '31234100678406', '31234100678414', '31234100678422', '31234100678430', '31234100678455', '31234100678463', '31234100678471', '31234100678497', '31234100678505', '31234100678513', '31234100678547', '31234100678554', '31234100678570', '31234100678588', '31234100678596', '31234100678604', '31234100678612', '31234100678620', '31234100678646', '31234100678653', '31234100678661', '31234100678679', '31234100678703', '31234100678729', '31234100678737', '31234100678745', '31234100678752', '31234100678760', '31234100678778', '31234100678786', '31234100678794', '31234100678802', '31234100678810', '31234100678828', '31234100678844', '31234100678851', '31234100678869', '31234100678885', '31234100678893', '31234100678901', '31234100679164', '31234100679198', '31234100679206', '31234100679222', '31234100679230', '31234100679248', '31234100679255', '31234100679263', '31234100679271', '31234100679289', '31234100679297', '31234100679305', '31234100679313', '31234100679321', '31234100679339', '31234100679347', '31234100680022', '31234100680204', '31234100680543', '31234100680576', '31234100681368', '31234100681467', '31234100681475', '31234100681673', '31234100681731', '31234100682267', '31234100682879', '31234100682903', '31234100682986', '31234100682994', '31234100683000', '31234100690674', '31234100690682', '31234100690690', '31234100690708', '31234100690716', '31234100690724', '31234100690732', '31234100690740', '31234100690757', '31234100690765', '31234100690773', '31234100690781', '31234100690799', '31234100690898', '31234100690906', '31234100690963', '31234100690971', '31234100690989', '31234100690997', '31234100691045', '31234100691136', '31234100691144', '31234100691169', '31234100691177', '31234100691185', '31234100691201', '31234100691235', '31234100691284', '31234100691300', '31234100691359', '31234100691367', '31234100691375', '31234100691391', '31234100691409', '31234100691417', '31234100691425', '31234100691433', '31234100691441', '31234100691458', '31234100691482', '31234100691490', '31234100691508', '31234100691516', '31234100691524', '31234100691532', '31234100691540', '31234100691557', '31234100691565', '31234100691573', '31234100691581', '31234100691599', '31234100691607', '31234100691615', '31234100691623', '31234100691631', '31234100691649', '31234100691656', '31234100691664', '31234100691672', '31234100691680', '31234100691706', '31234100691714', '31234100691722', '31234100691730', '31234100691854', '31234100691912', '31234100691938', '31234100691953', '31234100691961', '31234100691979', '31234100691987', '31234100691995', '31234100692027', '31234100692035', '31234100692043', '31234100692050', '31234100692068', '31234100692076', '31234100692084', '31234100692092', '31234100692100', '31234100692118', '31234100692126', '31234100692134', '31234100692142', '31234100692167', '31234100692175', '31234100692183', '31234100692191', '31234100692209', '31234100692217', '31234100692225', '31234100692233', '31234100692241', '31234100692258', '31234100692266', '31234100692274', '31234100692290', '31234100692308', '31234100692316', '31234100692324', '31234100692332', '31234100692340', '31234100692357', '31234100692365', '31234100692688', '31234100692712', '31234100693041', '31234100693090', '31234100693124', '31234100693207', '31234100693405', '31234100693413', '31234100693421', '31234100693447', '31234100693454', '31234100693462', '31234100693470', '31234100693496', '31234100693504', '31234100693512', '31234100693520', '31234100693538', '31234100693546', '31234100693553', '31234100693561', '31234100693579', '31234100693587', '31234100693603', '31234100693611', '31234100693629', '31234100693637', '31234100693645', '31234100693652', '31234100693660', '31234100693678', '31234100693686', '31234100693694', '31234100693702', '31234100693710', '31234100693728', '31234100693736', '31234100693744', '31234100693777', '31234100693785', '31234100693793', '31234100694023', '31234100694072', '31234100694262', '31234100694288', '31234100694502', '31234100694536', '31234100694627', '31234100694924', '31234100694981', '31234100694999', '31234100695095', '31234100695129', '31234100695145', '31234100695178', '31234100695186', '31234100695756', '31234100695764', '31234100695772', '31234100695798', '31234100695814', '31234100695822', '31234100695830', '31234100695848', '31234100695855', '31234100695889', '31234100695897', '31234100695905', '31234100695913', '31234100695921', '31234100695939', '31234100695947', '31234100695970', '31234100696762', '31234100696770', '31234100696978', '31234100697166', '31234100697331', '31234100698164', '31234100698180', '31234100699337', '31234100699857', '31234100700077', '31234100700085', '31234100700093', '31234100700119', '31234100700127', '31234100700135', '31234100700143', '31234100700150', '31234100700168', '31234100700176', '31234100700184', '31234100700192', '31234100700200', '31234100700218', '31234100700234', '31234100700242', '31234100700259', '31234100700267', '31234100700275', '31234100700283', '31234100700291', '31234100703378', '31234100703469', '31234100703485', '31234100703493', '31234100703519', '31234100703550', '31234100704467', '31234100708450', '31234100708468', '31234100708484', '31234100708492', '31234100708500', '31234100708518', '31234100708526', '31234100708534', '31234100708542', '31234100708559', '31234100708567', '31234100708575', '31234100708583', '31234100708591', '31234100708609', '31234100708617', '31234100708625', '31234100708633', '31234100708641', '31234100708658', '31234100708666', '31234100708674', '31234100708682', '31234100708690', '31234100708708', '31234100708716', '31234100708724', '31234100708732', '31234100708740', '31234100708757', '31234100708765', '31234100708773', '31234100708781', '31234100708807', '31234100708815', '31234100708823', '31234100708831', '31234100708849', '31234100708856', '31234100708864', '31234100708872', '31234100708880', '31234100708898', '31234100708906', '31234100708914', '31234100708922', '31234100708930', '31234100708948', '31234100708955', '31234100708963', '31234100708971', '31234100708989', '31234100708997', '31234100709003', '31234100709011', '31234100709029', '31234100709037', '31234100709045', '31234100709052', '31234100709060', '31234100709078', '31234100709086', '31234100709094', '31234100709102', '31234100709110', '31234100709128', '31234100709136', '31234100709144', '31234100709151', '31234100709169', '31234100709177', '31234100709193', '31234100709201', '31234100709219', '31234100709227', '31234100709235', '31234100709243', '31234100709250', '31234100709268', '31234100709276', '31234100709284', '31234100709292', '31234100709300', '31234100709318', '31234100709326', '31234100709334', '31234100709342', '31234100709359', '31234100709367', '31234100709375', '31234100709383', '31234100709391', '31234100709409', '31234100709417', '31234100709425', '31234100709433', '31234100709441', '31234100709458', '31234100709466', '31234100709474', '31234100709482', '31234100709490', '31234100709508', '31234100709516', '31234100709524', '31234100709532', '31234100709540', '31234100709557', '31234100709565', '31234100709573', '31234100709581', '31234100709599', '31234100709607', '31234100709615', '31234100709623', '31234100709631', '31234100709649', '31234100709656', '31234100709664', '31234100709672', '31234100709680', '31234100709698', '31234100709706', '31234100709714', '31234100709722', '31234100709730', '31234100709748', '31234100709755', '31234100709763', '31234100709797', '31234100709805', '31234100709813', '31234100709821', '31234100709839', '31234100709847', '31234100709854', '31234100709870', '31234100709888', '31234100709896', '31234100709904', '31234100709912', '31234100709920', '31234100709938', '31234100709946', '31234100709953', '31234100709961', '31234100709979', '31234100709987', '31234100709995', '31234100710001', '31234100710076', '31234100710084', '31234100710340', '31234100710365', '31234100710373', '31234100710381', '31234100710399', '31234100710407', '31234100710415', '31234100710423', '31234100710431', '31234100710449', '31234100710456', '31234100710555', '31234100710563', '31234100710571', '31234100710597', '31234100710647', '31234100710704', '31234100711173', '31234100711587', '31234100711827', '31234100712890', '31234100714904', '31234100715091', '31234100715422', '31234100715596', '31234100715604', '31234100715612', '31234100715661', '31234100715687', '31234100715695', '31234100715703', '31234100715711', '31234100715729', '31234100715737', '31234100715760', '31234100716750', '31234100717311', '31234100719333', '31234100719341', '31234100719358', '31234100719366', '31234100719374', '31234100719382', '31234100719390', '31234100719408', '31234100719432', '31234100720018', '31234100720026', '31234100720034', '31234100720042', '31234100720067', '31234100720075', '31234100720083', '31234100720091', '31234100720109', '31234100720133', '31234100720141', '31234100720158', '31234100720166', '31234100720174', '31234100720182', '31234100720190', '31234100720208', '31234100720216', '31234100720224', '31234100720232', '31234100720240', '31234100720265', '31234100720273', '31234100720281', '31234100720299', '31234100720307', '31234100720315', '31234100720323', '31234100720331', '31234100720364', '31234100720372', '31234100720380', '31234100720398', '31234100720406', '31234100720414', '31234100720422', '31234100720430', '31234100720448', '31234100720455', '31234100720463', '31234100720471', '31234100720489', '31234100720497', '31234100720505', '31234100720513', '31234100720521', '31234100720539', '31234100720547', '31234100720554', '31234100720562', '31234100720570', '31234100720588', '31234100720596', '31234100720604', '31234100720612', '31234100720620', '31234100720638', '31234100720679', '31234100720695', '31234100720703', '31234100720786', '31234100720836', '31234100720844', '31234100720851', '31234100720869', '31234100720877', '31234100720885', '31234100720893', '31234100720901', '31234100720919', '31234100720927', '31234100720935', '31234100720943', '31234100720950', '31234100720968', '31234100720976', '31234100720984', '31234100720992', '31234100721008', '31234100721016', '31234100721131', '31234100721149', '31234100721156', '31234100721164', '31234100721172', '31234100721180', '31234100721198', '31234100721206', '31234100721214', '31234100721222', '31234100721230', '31234100721248', '31234100721255', '31234100721263', '31234100721271', '31234100721289', '31234100721297', '31234100721305', '31234100721313', '31234100721321', '31234100721339', '31234100721347', '31234100721354', '31234100721362', '31234100721370', '31234100721388', '31234100721396', '31234100721404', '31234100721412', '31234100721420', '31234100721438', '31234100721446', '31234100721453', '31234100721461', '31234100721479', '31234100721487', '31234100721495', '31234100721503', '31234100721511', '31234100721529', '31234100721545', '31234100721552', '31234100721560', '31234100721578', '31234100721586', '31234100721594', '31234100721602', '31234100721610', '31234100721628', '31234100721636', '31234100721644', '31234100721651', '31234100721669', '31234100721677', '31234100721685', '31234100721693', '31234100721701', '31234100721719', '31234100721727', '31234100721735', '31234100721743', '31234100721750', '31234100721768', '31234100721776', '31234100721784', '31234100721792', '31234100721800', '31234100721818', '31234100721826', '31234100721834', '31234100721842', '31234100721859', '31234100721867', '31234100721875', '31234100721883', '31234100721891', '31234100721909', '31234100721917', '31234100721925', '31234100721933', '31234100721941', '31234100721958', '31234100721966', '31234100721974', '31234100721982', '31234100721990', '31234100722006', '31234100722014', '31234100722022', '31234100722030', '31234100722048', '31234100722055', '31234100722063', '31234100722071', '31234100722089', '31234100722097', '31234100722105', '31234100722113', '31234100722121', '31234100722139', '31234100722147', '31234100722154', '31234100722162', '31234100722170', '31234100722188', '31234100722196', '31234100722204', '31234100722212', '31234100722220', '31234100722238', '31234100722246', '31234100722253', '31234100722261', '31234100722279', '31234100722287', '31234100722295', '31234100722303', '31234100722311', '31234100722329', '31234100722337', '31234100722345', '31234100722352', '31234100722360', '31234100722378', '31234100722386', '31234100722394', '31234100722402', '31234100722410', '31234100722428', '31234100722436', '31234100722444', '31234100722451', '31234100722469', '31234100722501', '31234100725173', '31234100725181', '31234100725199', '31234100725207', '31234100725215', '31234100725223', '31234100725231', '31234100725249', '31234100725256', '31234100725264', '31234100725272', '31234100725280', '31234100725298', '31234100725306', '31234100725314', '31234100725322', '31234100725330', '31234100725348', '31234100725355', '31234100725363', '31234100725371', '31234100725389', '31234100725397', '31234100725405', '31234100725413', '31234100725421', '31234100725447', '31234100725454', '31234100725462', '31234100725470', '31234100725488', '31234100725496', '31234100725504', '31234100725512', '31234100725520', '31234100725538', '31234100725546', '31234100725553', '31234100725561', '31234100725579', '31234100725587', '31234100725595', '31234100725603', '31234100725611', '31234100725629', '31234100725637', '31234100725645', '31234100725652', '31234100725660', '31234100725678', '31234100725686', '31234100725694', '31234100725702', '31234100725710', '31234100725728', '31234100725736', '31234100725744', '31234100725751', '31234100725769', '31234100725777', '31234100725785', '31234100725793', '31234100725801', '31234100725819', '31234100725827', '31234100725835', '31234100725843', '31234100725850', '31234100725868', '31234100725876', '31234100725884', '31234100725892', '31234100725900', '31234100725918', '31234100725926', '31234100725934', '31234100725942', '31234100725959', '31234100725967', '31234100725975', '31234100725983', '31234100725991', '31234100726007', '31234100726015', '31234100726023', '31234100726031', '31234100726049', '31234100726056', '31234100726064', '31234100726072', '31234100726080', '31234100726098', '31234100726106', '31234100726114', '31234100726122', '31234100726130', '31234100726148', '31234100726155', '31234100726163', '31234100726171', '31234100726189', '31234100726197', '31234100726205', '31234100726213', '31234100726221', '31234100726239', '31234100726247', '31234100726262', '31234100726270', '31234100726288', '31234100726296', '31234100726304', '31234100726312', '31234100726320', '31234100726338', '31234100726346', '31234100726353', '31234100726361', '31234100726379', '31234100726387', '31234100726395', '31234100726403', '31234100726411', '31234100726429', '31234100726437', '31234100726445', '31234100726452', '31234100726460', '31234100726478', '31234100726486', '31234100726494', '31234100726502', '31234100726510', '31234100726528', '31234100726536', '31234100726544', '31234100726551', '31234100726569', '31234100726577', '31234100726585', '31234100726593', '31234100726601', '31234100726619', '31234100726627', '31234100726635', '31234100726643', '31234100726650', '31234100726668', '31234100726676', '31234100726684', '31234100726692', '31234100726700', '31234100726718', '31234100726726', '31234100726734', '31234100726742', '31234100726759', '31234100726767', '31234100726775', '31234100726783', '31234100726791', '31234100726809', '31234100726817', '31234100726825', '31234100726833', '31234100726841', '31234100726858', '31234100726866', '31234100726874', '31234100726882', '31234100726890', '31234100726908', '31234100726916', '31234100726924', '31234100726932', '31234100726940', '31234100726957', '31234100726965', '31234100726973', '31234100726981', '31234100726999', '31234100727005', '31234100727013', '31234100727021', '31234100727039', '31234100727047', '31234100727054', '31234100727062', '31234100727070', '31234100727088', '31234100727096', '31234100727104', '31234100727112', '31234100727120', '31234100727138', '31234100727146', '31234100727153', '31234100727161', '31234100727179', '31234100727187', '31234100727195', '31234100727203', '31234100727211', '31234100727229', '31234100727237', '31234100727245', '31234100727252', '31234100727260', '31234100727278', '31234100727286', '31234100727294', '31234100727302', '31234100727310', '31234100727328', '31234100727336', '31234100727344', '31234100727351', '31234100727369', '31234100727377', '31234100727385', '31234100727393', '31234100727401', '31234100727419', '31234100727427', '31234100727435', '31234100727443', '31234100727450', '31234100727468', '31234100727476', '31234100727484', '31234100727492', '31234100727500', '31234100727518', '31234100727526', '31234100727534', '31234100727542', '31234100727559', '31234100727567', '31234100727575', '31234100727583', '31234100727591', '31234100727609', '31234100727617', '31234100727625', '31234100727633', '31234100727641', '31234100727658', '31234100727666', '31234100727674', '31234100727682', '31234100727690', '31234100727708', '31234100727716', '31234100727724', '31234100727732', '31234100727740', '31234100727757', '31234100727765', '31234100727773', '31234100727781', '31234100727799', '31234100727807', '31234100727815', '31234100727823', '31234100727831', '31234100727849', '31234100727856', '31234100727864', '31234100727872', '31234100727880', '31234100727898', '31234100727906', '31234100727914', '31234100727922', '31234100727930', '31234100727948', '31234100727955', '31234100727963', '31234100727971', '31234100727989', '31234100727997', '31234100728003', '31234100728011', '31234100728029', '31234100728037', '31234100728045', '31234100728052', '31234100728060', '31234100728078', '31234100728086', '31234100728094', '31234100728102', '31234100728110', '31234100728128', '31234100728136', '31234100728995', '31234100729001', '31234100729019', '31234100729027', '31234100729035', '31234100729043', '31234100729050', '31234100729068', '31234100729076', '31234100729084', '31234100729092', '31234100729100', '31234100729118', '31234100729126', '31234100729134', '31234100729142', '31234100729159', '31234100729167', '31234100729175', '31234100729183', '31234100729191', '31234100729209', '31234100729217', '31234100729225', '31234100729233', '31234100729241', '31234100729258', '31234100729266', '31234100729274', '31234100729282', '31234100729290', '31234100729308', '31234100729316', '31234100729324', '31234100729332', '31234100729340', '31234100729357', '31234100729365', '31234100729373', '31234100729381', '31234100729399', '31234100729407', '31234100729415', '31234100729423', '31234100729431', '31234100729449', '31234100729456', '31234100729464', '31234100729472', '31234100729480', '31234100729498', '31234100729506', '31234100729514', '31234100729522', '31234100729530', '31234100729548', '31234100729555', '31234100729563', '31234100729571', '31234100729589', '31234100729597', '31234100729605', '31234100729613', '31234100729621', '31234100729639', '31234100729647', '31234100729654', '31234100729662', '31234100729670', '31234100729688', '31234100729696', '31234100729704', '31234100729712', '31234100729720', '31234100729738', '31234100729746', '31234100729753', '31234100729761', '31234100729779', '31234100729787', '31234100729795', '31234100729803', '31234100729811', '31234100729829', '31234100729837', '31234100729845', '31234100729852', '31234100729860', '31234100729878', '31234100729886', '31234100729894', '31234100729902', '31234100729910', '31234100729928', '31234100729936', '31234100729944', '31234100729951', '31234100729969', '31234100729977', '31234100729985', '31234100729993', '31234100730009', '31234100730017', '31234100730025', '31234100730033', '31234100730041', '31234100730058', '31234100730066', '31234100730074', '31234100730082', '31234100730090', '31234100730108', '31234100730116', '31234100730124', '31234100730132', '31234100730140', '31234100730157', '31234100730165', '31234100730173', '31234100730181', '31234100730199', '31234100730207', '31234100730215', '31234100730223', '31234100730231', '31234100730249', '31234100730264', '31234100730272', '31234100730280', '31234100730298', '31234100730306', '31234100730314', '31234100730322', '31234100730330', '31234100730348', '31234100730363', '31234100730371', '31234100730389', '31234100730397', '31234100730413', '31234100730421', '31234100730439', '31234100730454', '31234100730462', '31234100730470', '31234100730488', '31234100730496', '31234100730504', '31234100730520', '31234100730538', '31234100730553', '31234100730561', '31234100730579', '31234100730587', '31234100730595', '31234100730603', '31234100730611', '31234100730629', '31234100730637', '31234100730652', '31234100730660', '31234100730678', '31234100730686', '31234100730694', '31234100730702', '31234100730710', '31234100730728', '31234100730736', '31234100730744', '31234100730751', '31234100730769', '31234100730777', '31234100730785', '31234100730793', '31234100730801', '31234100730819', '31234100730843', '31234100730850', '31234100730876', '31234100730884', '31234100730892', '31234100730900', '31234100730918', '31234100730926', '31234100730934', '31234100730942', '31234100730959', '31234100730967', '31234100730975', '31234100730983', '31234100730991', '31234100731007', '31234100731015', '31234100731023', '31234100731031', '31234100731049', '31234100731056', '31234100731064', '31234100731072', '31234100731080', '31234100731098', '31234100731106', '31234100731114', '31234100731122', '31234100731130', '31234100731148', '31234100731155', '31234100731163', '31234100731171', '31234100731189', '31234100731197', '31234100731205', '31234100731213', '31234100731221', '31234100731239', '31234100731247', '31234100731254', '31234100731262', '31234100731270', '31234100731288', '31234100731296', '31234100731304', '31234100731312', '31234100731320', '31234100731338', '31234100731346', '31234100731353', '31234100731361', '31234100731379', '31234100731387', '31234100731395', '31234100731403', '31234100731411', '31234100731437', '31234100731445', '31234100731452', '31234100731460', '31234100731478', '31234100731486', '31234100731494', '31234100731502', '31234100731510', '31234100731528', '31234100731536', '31234100731544', '31234100731569', '31234100731577', '31234100731585', '31234100731593', '31234100731601', '31234100731619', '31234100731627', '31234100731635', '31234100731643', '31234100731650', '31234100731668', '31234100731676', '31234100731684', '31234100731692', '31234100731700', '31234100731718', '31234100731726', '31234100731734', '31234100731742', '31234100731759', '31234100731767', '31234100731775', '31234100731783', '31234100731791', '31234100731809', '31234100731817', '31234100731825', '31234100731833', '31234100731841', '31234100731858', '31234100731866', '31234100731874', '31234100731882', '31234100731890', '31234100731908', '31234100731916', '31234100731924', '31234100731932', '31234100731940', '31234100731957', '31234100731965', '31234100731973', '31234100731981', '31234100731999', '31234100732005', '31234100732013', '31234100732021', '31234100732039', '31234100732047', '31234100732054', '31234100732062', '31234100732070', '31234100732088', '31234100732096', '31234100732104', '31234100732112', '31234100732120', '31234100732138', '31234100732146', '31234100732153', '31234100732161', '31234100732179', '31234100732187', '31234100732195', '31234100732203', '31234100732211', '31234100732229', '31234100732237', '31234100732245', '31234100732252', '31234100732260', '31234100732278', '31234100732286', '31234100732294', '31234100732302', '31234100732310', '31234100732328', '31234100732336', '31234100734860', '31234100734886', '31234100734894', '31234100734902', '31234100734910', '31234100734928', '31234100734936', '31234100734944', '31234100734951', '31234100734969', '31234100734977', '31234100734985', '31234100734993', '31234100735008', '31234100735016', '31234100735024', '31234100735032', '31234100735040', '31234100735057', '31234100735065', '31234100735073', '31234100735081', '31234100735099', '31234100735107', '31234100735115', '31234100735123', '31234100735131', '31234100735149', '31234100735156', '31234100735164', '31234100735172', '31234100735180', '31234100735198', '31234100735206', '31234100735214', '31234100735222', '31234100735230', '31234100735248', '31234100735263', '31234100735271', '31234100735289', '31234100735297', '31234100735305', '31234100735313', '31234100735321', '31234100735339', '31234100735347', '31234100735354', '31234100735362', '31234100735370', '31234100735412', '31234100735420', '31234100735438', '31234100735446', '31234100735453', '31234100735461', '31234100735479', '31234100735487', '31234100735495', '31234100735503', '31234100735511', '31234100735529', '31234100735537', '31234100735545', '31234100735552', '31234100735560', '31234100735578', '31234100735586', '31234100735594', '31234100735602', '31234100735610', '31234100735628', '31234100735636', '31234100735644', '31234100735651', '31234100735669', '31234100735677', '31234100735685', '31234100735693', '31234100735701', '31234100735719', '31234100735727', '31234100735735', '31234100735743', '31234100735750', '31234100735768', '31234100735776', '31234100735784', '31234100735792', '31234100735800', '31234100735818', '31234100735826', '31234100735834', '31234100735842', '31234100735859', '31234100735867', '31234100735875', '31234100735883', '31234100735891', '31234100735909', '31234100735917', '31234100735933', '31234100735941', '31234100735958', '31234100735966', '31234100735974', '31234100735982', '31234100735990', '31234100736006', '31234100736014', '31234100736022', '31234100736030', '31234100736048', '31234100736055', '31234100736063', '31234100736071', '31234100736089', '31234100736097', '31234100736105', '31234100736113', '31234100736121', '31234100736139', '31234100736147', '31234100736154', '31234100736162', '31234100736170', '31234100736188', '31234100736196', '31234100736204', '31234100736212', '31234100736220', '31234100736238', '31234100736246', '31234100736253', '31234100736261', '31234100736279', '31234100736287', '31234100736295', '31234100736303', '31234100736311', '31234100736329', '31234100736337', '31234100736345', '31234100736352', '31234100736360', '31234100736378', '31234100736386', '31234100736394', '31234100736402', '31234100736410', '31234100736428', '31234100736436', '31234100736444', '31234100736451', '31234100736469', '31234100736477', '31234100736485', '31234100736493', '31234100736501', '31234100736519', '31234100736527', '31234100736535', '31234100736543', '31234100736550', '31234100736568', '31234100736576', '31234100736584', '31234100736592', '31234100736600', '31234100736618', '31234100736626', '31234100736634', '31234100736642', '31234100736659', '31234100736667', '31234100736675', '31234100736683', '31234100736691', '31234100736709', '31234100736717', '31234100736725', '31234100736733', '31234100736741', '31234100736758', '31234100736766', '31234100736774', '31234100736782', '31234100736790', '31234100736808', '31234100736816', '31234100736824', '31234100736832', '31234100736840', '31234100736857', '31234100736865', '31234100736873', '31234100736881', '31234100736899', '31234100736907', '31234100736915', '31234100736923', '31234100736931', '31234100736949', '31234100736956', '31234100736964', '31234100736972', '31234100736980', '31234100736998', '31234100737004', '31234100737012', '31234100737020', '31234100737038', '31234100737046', '31234100737053', '31234100737061', '31234100737079', '31234100737087', '31234100737095', '31234100737103', '31234100737111', '31234100737129', '31234100737137', '31234100737145', '31234100737152', '31234100737160', '31234100737178', '31234100737186', '31234100737194', '31234100737202', '31234100737210', '31234100737228', '31234100737236', '31234100737244', '31234100737251', '31234100737269', '31234100737277', '31234100737285', '31234100737293', '31234100737301', '31234100737319', '31234100737327', '31234100737335', '31234100737343', '31234100737350', '31234100737368', '31234100737376', '31234100737384', '31234100737392', '31234100737400', '31234100737418', '31234100737426', '31234100737434', '31234100737442', '31234100737459', '31234100737467', '31234100737475', '31234100737483', '31234100737491', '31234100737509', '31234100737517', '31234100737525', '31234100737533', '31234100737541', '31234100737558', '31234100737566', '31234100737574', '31234100737582', '31234100737590', '31234100737608', '31234100737616', '31234100737624', '31234100737632', '31234100737640', '31234100737657', '31234100737665', '31234100737673', '31234100739232', '31234100739257', '31234100740016', '31234100740024', '31234100740032', '31234100740040', '31234100740057', '31234100740065', '31234100740073', '31234100740081', '31234100740099', '31234100740107', '31234100740115', '31234100740123', '31234100740131', '31234100740149', '31234100740156', '31234100740164', '31234100740172', '31234100740180', '31234100740198', '31234100740206', '31234100740214', '31234100740222', '31234100740230', '31234100740248', '31234100740255', '31234100740263', '31234100740271', '31234100740289', '31234100740297', '31234100740305', '31234100740313', '31234100740321', '31234100740339', '31234100740347', '31234100740354', '31234100740362', '31234100740370', '31234100740388', '31234100740396', '31234100740404', '31234100740412', '31234100740420', '31234100740438', '31234100740446', '31234100740453', '31234100740461', '31234100740487', '31234100740503', '31234100740511', '31234100740529', '31234100740537', '31234100740545', '31234100740552', '31234100740560', '31234100740578', '31234100740586', '31234100740594', '31234100740602', '31234100740610', '31234100740628', '31234100740636', '31234100740644', '31234100740651', '31234100740669', '31234100740685', '31234100740693', '31234100740701', '31234100740719', '31234100740727', '31234100740743', '31234100740750', '31234100740768', '31234100740776', '31234100740784', '31234100740792', '31234100740800', '31234100740818', '31234100740826', '31234100740842', '31234100740867', '31234100740875', '31234100740883', '31234100740891', '31234100740909', '31234100740917', '31234100740925', '31234100740933', '31234100740941', '31234100740958', '31234100740966', '31234100740974', '31234100740982', '31234100740990', '31234100741006', '31234100741014', '31234100741022', '31234100741030', '31234100741048', '31234100741055', '31234100741063', '31234100741071', '31234100741089', '31234100741097', '31234100741105', '31234100741113', '31234100741121', '31234100741139', '31234100741147', '31234100741154', '31234100741162', '31234100741170', '31234100741188', '31234100741196', '31234100741204', '31234100741212', '31234100741477', '31234100741485', '31234100741501', '31234100741519', '31234100741527', '31234100741535', '31234100741543', '31234100741550', '31234100741568', '31234100741576', '31234100741584', '31234100741592', '31234100741600', '31234100741618', '31234100741626', '31234100741634', '31234100741642', '31234100741659', '31234100741667', '31234100741675', '31234100741683', '31234100741691', '31234100741709', '31234100741717', '31234100741725', '31234100741733', '31234100741741', '31234100741758', '31234100741766', '31234100741774', '31234100741782', '31234100741808', '31234100741816', '31234100741824', '31234100741832', '31234100741840', '31234100741857', '31234100741865', '31234100741873', '31234100741881', '31234100741899', '31234100741907', '31234100741915', '31234100741923', '31234100741931', '31234100741949', '31234100741956', '31234100741964', '31234100741972', '31234100741980', '31234100741998', '31234100742012', '31234100742020', '31234100742038', '31234100742046', '31234100742053', '31234100742061', '31234100742079', '31234100742087', '31234100742095', '31234100742103', '31234100742111', '31234100742129', '31234100742137', '31234100742145', '31234100742152', '31234100742160', '31234100742178', '31234100742186', '31234100742194', '31234100742202', '31234100742210', '31234100742228', '31234100742236', '31234100742244', '31234100742251', '31234100742269', '31234100742285', '31234100742293', '31234100742301', '31234100742319', '31234100742327', '31234100742335', '31234100742566', '31234100742574', '31234100742582', '31234100742590', '31234100742608', '31234100742616', '31234100742624', '31234100742632', '31234100742640', '31234100742657', '31234100742665', '31234100742673', '31234100742681', '31234100742699', '31234100742707', '31234100742715', '31234100742723', '31234100742749', '31234100742756', '31234100742772', '31234100742780', '31234100742798', '31234100742806', '31234100742814', '31234100742822', '31234100742830', '31234100742848', '31234100742855', '31234100742863', '31234100742871', '31234100742889', '31234100742897', '31234100742905', '31234100742913', '31234100742921', '31234100742939', '31234100742947', '31234100742954', '31234100742962', '31234100742970', '31234100742988', '31234100742996', '31234100743010', '31234100743028', '31234100743036', '31234100743044', '31234100743051', '31234100743069', '31234100743077', '31234100743085', '31234100743093', '31234100743101', '31234100743119', '31234100743127', '31234100743135', '31234100743143', '31234100743150', '31234100743168', '31234100743176', '31234100743184', '31234100743192', '31234100743200', '31234100743218', '31234100743226', '31234100743234', '31234100743242', '31234100743259', '31234100743267', '31234100743275', '31234100743283', '31234100743291', '31234100743309', '31234100743317', '31234100743325', '31234100750270', '31234100751732', '31234100751757', '31234100751799', '31234100751823', '31234100751831', '31234100751849', '31234100751864', '31234100751914', '31234100751922', '31234100751930', '31234100751948', '31234100752003', '31234100752516', '31234100752524', '31234100752532', '31234100752540', '31234100752557', '31234100752565', '31234100752573', '31234100752581', '31234100752599', '31234100752607', '31234100752615', '31234100753605', '31234100755931', '31234100755949', '31234100755956', '31234100757036', '31234100757044', '31234100757051', '31234100757077', '31234100757085', '31234100757093', '31234100757101', '31234100757119', '31234100757127', '31234100757135', '31234100757143', '31234100757150', '31234100757168', '31234100757176', '31234100757184', '31234100757192', '31234100757200', '31234100757218', '31234100757226', '31234100757234', '31234100757242', '31234100757259', '31234100757267', '31234100757275', '31234100757283', '31234100757291', '31234100757309', '31234100757325', '31234100757366', '31234100757382', '31234100757408', '31234100757416', '31234100757424', '31234100757432', '31234100757440', '31234100757457', '31234100757465', '31234100757473', '31234100757481', '31234100757499', '31234100757507', '31234100757515', '31234100757523', '31234100757531', '31234100757549', '31234100757556', '31234100757564', '31234100757580', '31234100757598', '31234100757614', '31234100757622', '31234100757630', '31234100757648', '31234100757663', '31234100757671', '31234100757689', '31234100757697', '31234100757705', '31234100757713', '31234100757721', '31234100757739', '31234100757747', '31234100757754', '31234100757762', '31234100757770', '31234100757788', '31234100757796', '31234100757812', '31234100757820', '31234100757853', '31234100757861', '31234100757879')";

//execute the above query
$result=mysqli_query($conn,$query);

//store the number of records to be exported
$numrows = number_format(mysqli_num_rows($result));
echo "<br><br><center><strong><h2><u>Exporting $numrows records to CSV and DwC-A</u></h2></strong></center><br>";
ob_flush();
flush();

//define file handlers for read/write of the files found within the DwC-A
$handleo = fopen($dwcafileo, "w");
$handlei = fopen($dwcafilei, "w");
$handlea = fopen($dwcafilea, "w");
$handlem = fopen($dwcafilem, "w");

//define variables to hold the headers for each CSV file to be written
$idline = 'id' . "," . 'institutionCode' . ","  . 'collectionCode' . "," . 'ownerInstitutionCode' . "," . 'basisOfRecord' . "," . 'occurrenceID' . "," . 'catalogNumber' . "," . 'otherCatalogNumbers' . "," . 'kingdom' . "," . 'phylum' . "," . 'class' . "," . 'order' . "," . 'family' . "," . 'scientificName' . "," . 'tidInterpreted' . "," . 'scientificNameAuthorship' . "," . 'genus' . "," . 'specificEpithet' . "," . 'taxonRank' . "," . 'infraspecificEpithet' . "," . 'identifiedBy' . "," . 'dateIdentified' . "," . 'identificationReferences' . "," . 'identificationRemarks' . "," . 'taxonRemarks' . "," . 'identificationQualifier' . "," . 'typeStatus' . "," . 'recordedBy' . "," . 'recordedByID' . "," . 'associatedCollectors' . "," . 'recordNumber' . "," . 'eventDate' . "," . 'year' . "," . 'month' . "," . 'day' . "," . 'startDayOfYear' . "," . 'endDayOfYear' . "," . 'verbatimEventDate' . "," . 'occurrenceRemarks' . "," . 'habitat' . "," . 'substrate' . "," . 'verbatimAttributes' . "," . 'fieldNumber' . "," . 'informationWithheld' . "," . 'dataGeneralizations' . "," . 'dynamicProperties' . "," . 'associatedTaxa' . "," . 'reproductiveCondition' . "," . 'establishmentMeans' . "," . 'cultivationStatus' . "," . 'lifeStage' . "," . 'sex' . "," . 'individualCount' . "," . 'samplingProtocol' . "," . 'samplingEffort' . "," . 'preparations' . "," . 'country' . "," . 'stateProvince' . "," . 'county' . "," . 'municipality' . "," . 'locality' . "," . 'locationRemarks' . "," . 'localitySecurity' . "," . 'localitySecurityReason' . "," . 'decimalLatitude' . "," . 'decimalLongitude' . "," . 'geodeticDatum' . "," . 'coordinateUncertaintyInMeters' . "," . 'verbatimCoordinates' . "," . 'georeferencedBy' . "," . 'georeferenceProtocol' . "," . 'georeferenceSources' . "," . 'georeferenceVerificationStatus' . "," . 'georeferenceRemarks' . "," . 'minimumElevationInMeters' . "," . 'maximumElevationInMeters' . "," . 'minimumDepthInMeters' . "," . 'maximumDepthinMeters' . "," . 'verbatimDepth' . "," . 'verbatimElevation' . "," . 'disposition' . "," . 'language' . "," . 'genericcolumn1' . "," . 'genericcolumn2' . "," . 'storageLocation' . "," . 'observerUid' . "," . 'processingStatus' . "," . 'duplicateQuantity' . "," . 'recordEnteredBy' . "," . 'dateEntered' . "," . 'dateLastModified' . "," . 'modified' . "," . 'sourcePrimaryKey' . "," . 'recordId' . "," . 'references' . PHP_EOL;
$iline = 'coreid' . "," . 'identifier' . "," . 'accessURI' . "," . 'thumbnailAccessURI' . "," . 'goodQualityAccessURI' . "," . 'rights' . "," . 'caption' . "," . 'comments' . "," . 'providerManagedID' . "," . 'MetadataDate' . "," . 'format' . "," . 'associatedSpecimenReference' . "," . 'type' . "," . 'subtype' . "," . 'metadataLanguage' . PHP_EOL;
$aline = 'coreid' . "," . 'identifiedBy' . "," . 'identifiedByID' . "," . 'dateIdentified' . "," . 'identificationQualifier' . "," . 'scientificName' . "," . 'tidInterpreted' . "," . 'identificationIsCurrent' . "," . 'scientificNameAuthorship' . "," . 'genus' . "," . 'specificEpithet' . "," . 'taxonRank' . "," . 'infraspecificEpithet' . "," . 'identificationReferences' . "," . 'identificationRemarks' . "," . 'recordID' . "," . 'modified' . PHP_EOL;
$mline = 'coreid' . "," . 'measurementType' . "," . 'measurementTypeID' . "," . 'measurementValue' . "," . 'measurementValueID' . "," . 'measurementUnit' . "," . 'measurementDeterminedDate' . "," . 'measurementDeterminedBy' . "," . 'measurementRemarks' . PHP_EOL;

//write the headers to each CSV file to be written
fwrite($handleo, $idline);
fwrite($handlei, $iline);
fwrite($handlea, $aline);
fwrite($handlem, $mline);

//fetch each row that is to be written to the CSV files
while ($dwcaf = mysqli_fetch_array($result, MYSQLI_ASSOC)) {
		//build the line to be added to the CSV file from the array elements
	$line = "\"" . $dwcaf['id'] . "\",\"" . $dwcaf['institutionCode'] . "\",\"" . $dwcaf['collectionCode'] . "\",\"" . $dwcaf['ownerInstitutionCode'] . "\",\"" . $dwcaf['basisOfRecord'] . "\",\"" . $dwcaf['occurrenceID'] . "\",\"" . $dwcaf['catalogNumber'] . "\",\"" . $dwcaf['otherCatalogNumbers'] . "\",\"" . $dwcaf['kingdom'] . "\",\"" . $dwcaf['phylum'] . "\",\"" . $dwcaf['class'] . "\",\"" . $dwcaf['order'] . "\",\"" . $dwcaf['family'] . "\",\"" . $dwcaf['scientificName'] . "\",\"" . $dwcaf['tidInterpreted'] . "\",\"" . $dwcaf['scientificNameAuthorship'] . "\",\"" . $dwcaf['genus'] . "\",\"" . $dwcaf['specificEpithet'] . "\",\"" . $dwcaf['taxonRank'] . "\",\"" . $dwcaf['infraspecificEpithet'] . "\",\"" . $dwcaf['identifiedBy'] . "\",\"" . $dwcaf['dateIdentified'] . "\",\"" . $dwcaf['identificationReferences'] . "\",\"" . $dwcaf['identificationRemarks'] . "\",\"" . $dwcaf['taxonRemarks'] . "\",\"" . $dwcaf['identificationQualifier'] . "\",\"" . $dwcaf['typeStatus'] . "\",\"" . $dwcaf['recordedBy'] . "\",\"" . $dwcaf['recordedByID'] . "\",\"" . $dwcaf['associatedCollectors'] . "\",\"" . $dwcaf['recordNumber'] . "\",\"" . $dwcaf['eventDate'] . "\",\"" . $dwcaf['year'] . "\",\"" . $dwcaf['month'] . "\",\"" . $dwcaf['day'] . "\",\"" . $dwcaf['startDayOfYear'] . "\",\"" . $dwcaf['endDayOfYear'] . "\",\"" . $dwcaf['verbatimEventDate'] . "\",\"" . $dwcaf['occurrenceRemarks'] . "\",\"" . $dwcaf['habitat'] . "\",\"" . $dwcaf['substrate'] . "\",\"" . $dwcaf['verbatimAttributes'] . "\",\"" . $dwcaf['fieldNumber'] . "\",\"" . $dwcaf['informationWithheld'] . "\",\"" . $dwcaf['dataGeneralizations'] . "\",\"" . $dwcaf['dynamicProperties'] . "\",\"" . $dwcaf['associatedTaxa'] . "\",\"" . $dwcaf['reproductiveCondition'] . "\",\"" . $dwcaf['establishmentMeans'] . "\",\"" . $dwcaf['cultivationStatus'] . "\",\"" . $dwcaf['lifeStage'] . "\",\"" . $dwcaf['sex'] . "\",\"" . $dwcaf['individualCount'] . "\",\"" . $dwcaf['samplingProtocol'] . "\",\"" . $dwcaf['samplingEffort'] . "\",\"" . $dwcaf['preparations'] . "\",\"" . $dwcaf['country'] . "\",\"" . $dwcaf['stateProvince'] . "\",\"" . $dwcaf['county'] . "\",\"" . $dwcaf['municipality'] . "\",\"" . $dwcaf['locality'] . "\",\"" . $dwcaf['locationRemarks'] . "\",\"" . $dwcaf['localitySecurity'] . "\",\"" . $dwcaf['localitySecurityReason'] . "\",\"" . $dwcaf['decimalLatitude'] . "\",\"" . $dwcaf['decimalLongitude'] . "\",\"" . $dwcaf['geodeticDatum'] . "\",\"" . $dwcaf['coordinateUncertaintyInMeters'] . "\",\"" . $dwcaf['verbatimCoordinates'] . "\",\"" . $dwcaf['georeferencedBy'] . "\",\"" . $dwcaf['georeferenceProtocol'] . "\",\"" . $dwcaf['georeferenceSources'] . "\",\"" . $dwcaf['georeferenceVerificationStatus'] . "\",\"" . $dwcaf['georeferenceRemarks'] . "\",\"" . $dwcaf['minimumElevationInMeters'] . "\",\"" . $dwcaf['maximumElevationInMeters'] . "\",\"" . $dwcaf['minimumDepthInMeters'] . "\",\"" . $dwcaf['maximumDepthinMeters'] . "\",\"" . $dwcaf['verbatimDepth'] . "\",\"" . $dwcaf['verbatimElevation'] . "\",\"" . $dwcaf['disposition'] . "\",\"" . $dwcaf['language'] . "\",\"" . $dwcaf['genericcolumn1'] . "\",\"" . $dwcaf['genericcolumn2'] . "\",\"" . $dwcaf['storageLocation'] . "\",\"" . $dwcaf['recordEnteredBy'] . "\",\"" . $dwcaf['observerUid'] . "\",\"" . $dwcaf['processingStatus'] . "\",\"" . $dwcaf['duplicateQuantity'] . "\",\"" . $dwcaf['dateEntered'] . "\",\"" . $dwcaf['dateLastModified'] . "\",\"" . $dwcaf['modified'] . "\",\"" . $dwcaf['sourcePrimaryKey'] . "\",\"" . $dwcaf['recordId'] . "\",\"" . $dwcaf['references'] . "\"" . PHP_EOL;
	//set the variable to the id number from that row of data retrieved from the database
	$dwcaid = $dwcaf['id'];
	//build query strings to fetch data from other tables belonging to an ID found within the occurrence record
	$query2 = "SELECT * FROM `images` WHERE `coreid` = $dwcaid";
	$query3 = "SELECT * FROM `identifications` WHERE `coreid` = $dwcaid";
  $query4 = "SELECT * FROM `measurementorfact` WHERE `coreid` = $dwcaid";
  //fetch the result of the above queries
	$result2=mysqli_query($conn,$query2);
	$result3=mysqli_query($conn,$query3);
  $result4=mysqli_query($conn,$query4);
  //retrieve row by row the results the query (coreid in Images table)
 while ($dwcaif = mysqli_fetch_array($result2, MYSQLI_ASSOC)) {
	//build the line to be added to the Images CSV using elements from an array
	$iline2 = "\"" . $dwcaif['coreid'] . "\",\"" . $dwcaif['identifier'] . "\",\"" . $dwcaif['accessURI'] . "\",\"" . $dwcaif['thumbnailAccessURI'] . "\",\"" . $dwcaif['goodQualityAccessURI'] . "\",\"" . $dwcaif['rights'] . "\",\"" . $dwcaif['caption'] . "\",\"" . $dwcaif['comments'] . "\",\"" . $dwcaif['providerManagedID'] . "\",\"" . $dwcaif['MetadataDate'] . "\",\"" . $dwcaif['format'] . "\",\"" . $dwcaif['associatedSpecimenReference'] . "\",\"" . $dwcaif['type'] . "\",\"" . $dwcaif['subtype'] . "\",\"" . $dwcaif['metadataLanguage'] . "\"" . PHP_EOL;
	//write the line to the Images.CSV
	fwrite($handlei,$iline2);
	}
 //retrieve row by row the results of the query (coreid in Identfications table)
 while ($dwcaaf = mysqli_fetch_array($result3, MYSQLI_ASSOC)) {
		//build the line to be added to the Identificationscsv using elements from an array
		@$aline2 = "\"" . $dwcaaf['coreid'] . "\",\"" . $dwcaaf['identifiedBy'] . "\",\"" . $dwcaaf['identifiedByID'] . "\",\"" . $dwcaaf['dateIdentified'] . "\",\"" . $dwcaaf['identificationQualifier'] . "\",\"" . $dwcaaf['scientificName'] . "\",\"" . $dwcaaf['tidInterpreted'] . "\",\"" . $dwcaaf['identificationIsCurrent'] . "\",\"" . $dwcaaf['scientificNameAuthorship'] . "\",\"" . $dwcaaf['genus'] . "\",\"" . $dwcaaf['specificEpithet'] . "\",\"" . $dwcaaf['taxonRank'] . "\",\"" . $dwcaaf['infraspecificEpithet'] . "\",\"" . $dwcaaf['identificationReferences'] . "\",\"" . $dwcaaf['identificationRemarks'] . "\",\"" . $dwcaaf['recordID'] . "\",\"" . $dwcaaf['modified'] . "\"" . PHP_EOL;		
		//write the line to the Identifications.CSV
		fwrite($handlea,$aline2);
	} 
	//retrieve row by row the results of the query (coreid in MeasurementOrFacts table)
 while ($dwcamf = mysqli_fetch_array($result4, MYSQLI_ASSOC)) {
	//build the line to be added to the measurementOrFact.CSV
	$mline2 = "\"" . $dwcamf['coreid'] . "\",\"" . $dwcamf['measurementType'] . "\",\"" . $dwcamf['measurementTypeID'] . "\",\"" . $dwcamf['measurementValue'] . "\",\"" . $dwcamf['measurementValueID'] . "\",\"" . $dwcamf['measurementUnit'] . "\",\"" . $dwcamf['measurementDeterminedDate'] . "\",\"" . $dwcamf['measurementDeterminedBy'] . "\",\"" . $dwcamf['measurementRemarks'] . "\",\"" . PHP_EOL;		
	//write the line to the measurementOrFact.CSV
	fwrite($handlem,$mline2);
	} 
  //write the line to be added to the Occurrences.CSV
	fwrite($handleo, $line);
};

//close all the open file handles
fclose($handleo);
fclose($handlei);
fclose($handlea);
fclose($handlem);

$ocount =number_format(count(file($dwcafileo)) - 1);
$acount =number_format(count(file($dwcafilea)) - 1);
$icount =number_format(count(file($dwcafilei)) - 1);
$mcount =number_format(count(file($dwcafilem)) - 1);

echo "<center><strong>Occurrences.CSV = $ocount rows written.</center><br>";
echo "<center><strong>Identifications.CSV = $acount rows records written</center><br>";
echo "<center><strong>Images.CSV = $icount rows written</center><br>";
echo "<center><strong>MeasurementsOrFact.CSV = $mcount rows written</center><br>";
echo "<br>";
echo "<center><strong>Writing XML files</center><br>";
echo "<center><strong>Creating the DwC-A Zip file...</center><br>";
ob_flush();
flush();
//set variables to hold the values of the eml.xml
$eml1 = '<?xml version="1.0" encoding="UTF-8"?>' . PHP_EOL;
$eml2 = '<eml:eml xmlns:eml="eml://ecoinformatics.org/eml-2.1.1" xmlns:dc="http://purl.org/dc/terms/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="eml://ecoinformatics.org/eml-2.1.1 http://rs.gbif.org/schema/eml-gbif-profile/1.0.1/eml.xsd" packageId="0fe788dd-03a7-49de-aa55-945c487d101b" system="http://symbiota.org" scope="system" xml:lang="eng"><dataset><alternateIdentifier>http://sernecportal.org/portal/collections/misc/collprofiles.php?collid=193</alternateIdentifier><title xml:lang="eng">Eastern Kentucky University, Ronald L. Jones Herbarium</title><creator id="17dd4489-ee9c-414a-b99b-871873f3d335"><organizationName>SERNEC</organizationName><electronicMailAddress>herrick.brown@gmail.com</electronicMailAddress><onlineUrl>http://sernecportal.org/portal/index.php</onlineUrl></creator><metadataProvider><organizationName>SERNEC</organizationName><electronicMailAddress>herrick.brown@gmail.com</electronicMailAddress><onlineUrl>http://sernecportal.org/portal/index.php</onlineUrl></metadataProvider><pubDate>2017-09-28</pubDate><language>eng</language><abstract><para>The EKU Herbarium (EKY) contains ~77,000 specimens and is the largest collection in Kentucky, and the second largest in the Kentucky-Tennessee region (surpassed only by the University of Tennessee). Most specimens are from central and eastern Kentucky, but also there is a good representation of western Kentucky and of the southeastern United States. There is also a set of woody plant specimens recently collected in Costa Rica. Nearly all specimens are of vascular plants. A number of important sets of specimens are housed at EKY, including sets from Lilley Cornett Woods, Maywoods Environmental and Educational Laboratory, Pine Mountain, Breaks Interstate Park, Brodhead Swamp, the headwater regions of the Green River, collections from the Kentucky State Nature Preserves Commission, collections of Mary Wharton, E.T. Browne, Raymond Athey, and county collections from Madison, Estill, Jackson, and Garrard Counties.</para></abstract><contact><individualName>Brad R. Ruhfel</individualName><organizationName>Eastern Kentucky University, Ronald L. Jones Herbarium</organizationName><phone></phone><electronicMailAddress>brad.ruhfel@eku.edu</electronicMailAddress><onlineUrl>http://herbarium.eku.edu/</onlineUrl></contact><associatedParty><individualName>Robert</individualName><role>CONTENT_PROVIDER</role></associatedParty><associatedParty><organizationName>Eastern Kentucky University, Ronald L. Jones Herbarium</organizationName><individualName>Brad R. Ruhfel</individualName><positionName>Collection Manager</positionName><role>CONTENT_PROVIDER</role><electronicMailAddress>brad.ruhfel@eku.edu</electronicMailAddress><phone></phone><address><deliveryPoint>Moore Building, Room 349</deliveryPoint><city>Richmond</city><administrativeArea>KY</administrativeArea><postalCode>40475</postalCode><country>USA</country></address></associatedParty><intellectualRights><para>To the extent possible under law, the publisher has waived all rights to these data and has dedicated them to the <ulink url="http://creativecommons.org/licenses/by-nc/3.0/legalcode"><citetitle>CC BY-NC (Attribution-Non-Commercial)</citetitle></ulink>Users can copy, redistribute the material in any medium or format, remix, transform, and build upon the material. The licensor cannot revoke these freedoms as long as you follow the license terms.</para></intellectualRights></dataset><additionalMetadata><metadata><symbiota><dateStamp>2017-09-28T10:20:53-07:00</dateStamp><citation identifier="1a4f4a30-84b1-468b-8182-954b07d2cc16">SERNEC - 1a4f4a30-84b1-468b-8182-954b07d2cc16</citation><physical><characterEncoding>UTF-8</characterEncoding><dataFormat><externallyDefinedFormat><formatName>Darwin Core Archive</formatName></externallyDefinedFormat></dataFormat></physical><collection identifier="0fdd3b88-7ca2-48ad-92e0-23e26acec000" id="193"><alternateIdentifier>http://sernecportal.org/portal/collections/misc/collprofiles.php?collid=193</alternateIdentifier><parentCollectionIdentifier>EKY</parentCollectionIdentifier><collectionIdentifier></collectionIdentifier><collectionName>Eastern Kentucky University, Ronald L. Jones Herbarium</collectionName><resourceLogoUrl>http://sernecportal.org/portal/images/collicons/eky2.jpg</resourceLogoUrl><onlineUrl>http://herbarium.eku.edu/</onlineUrl><intellectualRights>http://creativecommons.org/licenses/by-nc/3.0/</intellectualRights><abstract><para>The EKU Herbarium (EKY) contains ~77,000 specimens and is the largest collection in Kentucky, and the second largest in the Kentucky-Tennessee region (surpassed only by the University of Tennessee). Most specimens are from central and eastern Kentucky, but also there is a good representation of western Kentucky and of the southeastern United States. There is also a set of woody plant specimens recently collected in Costa Rica. Nearly all specimens are of vascular plants. A number of important sets of specimens are housed at EKY, including sets from Lilley Cornett Woods, Maywoods Environmental and Educational Laboratory, Pine Mountain, Breaks Interstate Park, Brodhead Swamp, the headwater regions of the Green River, collections from the Kentucky State Nature Preserves Commission, collections of Mary Wharton, E.T. Browne, Raymond Athey, and county collections from Madison, Estill, Jackson, and Garrard Counties.</para></abstract></collection></symbiota></metadata></additionalMetadata></eml:eml>' . PHP_EOL;

//create a handle to the eml.xml file as writable
$fhandle_eml=fopen($dwcaeml, "w");
//write the two variables and close the file handle
fwrite($fhandle_eml,$eml1);
fwrite($fhandle_eml,$eml2);
fclose($fhandle_eml);
//set variables to hold the values of meta.xml
$meta1 = '<?xml version="1.0" encoding="UTF-8"?>' . PHP_EOL;
$meta2 = '<archive xmlns="http://rs.tdwg.org/dwc/text/" metadata="eml.xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://rs.tdwg.org/dwc/text/   http://rs.tdwg.org/dwc/text/tdwg_dwc_text.xsd"><core dateFormat="YYYY-MM-DD" encoding="UTF-8" fieldsTerminatedBy="," linesTerminatedBy="\n" fieldsEnclosedBy="&quot;" ignoreHeaderLines="1" rowType="http://rs.tdwg.org/dwc/terms/Occurrence"><files><location>occurrences.csv</location></files><id index="0"/><field index="1" term="http://rs.tdwg.org/dwc/terms/institutionCode"/><field index="2" term="http://rs.tdwg.org/dwc/terms/collectionCode"/><field index="3" term="http://rs.tdwg.org/dwc/terms/ownerInstitutionCode"/><field index="4" term="http://rs.tdwg.org/dwc/terms/basisOfRecord"/><field index="5" term="http://rs.tdwg.org/dwc/terms/occurrenceID"/><field index="6" term="http://rs.tdwg.org/dwc/terms/catalogNumber"/><field index="7" term="http://rs.tdwg.org/dwc/terms/otherCatalogNumbers"/><field index="8" term="http://rs.tdwg.org/dwc/terms/kingdom"/><field index="9" term="http://rs.tdwg.org/dwc/terms/phylum"/><field index="10" term="http://rs.tdwg.org/dwc/terms/class"/><field index="11" term="http://rs.tdwg.org/dwc/terms/order"/><field index="12" term="http://rs.tdwg.org/dwc/terms/family"/><field index="13" term="http://rs.tdwg.org/dwc/terms/scientificName"/><field index="14" term="http://symbiota.org/terms/tidInterpreted"/><field index="15" term="http://rs.tdwg.org/dwc/terms/scientificNameAuthorship"/><field index="16" term="http://rs.tdwg.org/dwc/terms/genus"/><field index="17" term="http://rs.tdwg.org/dwc/terms/specificEpithet"/><field index="18" term="http://rs.tdwg.org/dwc/terms/taxonRank"/><field index="19" term="http://rs.tdwg.org/dwc/terms/infraspecificEpithet"/><field index="20" term="http://rs.tdwg.org/dwc/terms/identifiedBy"/><field index="21" term="http://rs.tdwg.org/dwc/terms/dateIdentified"/><field index="22" term="http://rs.tdwg.org/dwc/terms/identificationReferences"/><field index="23" term="http://rs.tdwg.org/dwc/terms/identificationRemarks"/><field index="24" term="http://rs.tdwg.org/dwc/terms/taxonRemarks"/><field index="25" term="http://rs.tdwg.org/dwc/terms/identificationQualifier"/><field index="26" term="http://rs.tdwg.org/dwc/terms/typeStatus"/><field index="27" term="http://rs.tdwg.org/dwc/terms/recordedBy"/><field index="28" term="http://symbiota.org/terms/recordedByID"/><field index="29" term="http://symbiota.org/terms/associatedCollectors"/><field index="30" term="http://rs.tdwg.org/dwc/terms/recordNumber"/><field index="31" term="http://rs.tdwg.org/dwc/terms/eventDate"/><field index="32" term="http://rs.tdwg.org/dwc/terms/year"/><field index="33" term="http://rs.tdwg.org/dwc/terms/month"/><field index="34" term="http://rs.tdwg.org/dwc/terms/day"/><field index="35" term="http://rs.tdwg.org/dwc/terms/startDayOfYear"/><field index="36" term="http://rs.tdwg.org/dwc/terms/endDayOfYear"/><field index="37" term="http://rs.tdwg.org/dwc/terms/verbatimEventDate"/><field index="38" term="http://rs.tdwg.org/dwc/terms/occurrenceRemarks"/><field index="39" term="http://rs.tdwg.org/dwc/terms/habitat"/><field index="40" term="http://symbiota.org/terms/substrate"/><field index="41" term="http://symbiota.org/terms/verbatimAttributes"/><field index="42" term="http://rs.tdwg.org/dwc/terms/fieldNumber"/><field index="43" term="http://rs.tdwg.org/dwc/terms/informationWithheld"/><field index="44" term="http://rs.tdwg.org/dwc/terms/dataGeneralizations"/><field index="45" term="http://rs.tdwg.org/dwc/terms/dynamicProperties"/><field index="46" term="http://rs.tdwg.org/dwc/terms/associatedTaxa"/><field index="47" term="http://rs.tdwg.org/dwc/terms/reproductiveCondition"/><field index="48" term="http://rs.tdwg.org/dwc/terms/establishmentMeans"/><field index="49" term="http://symbiota.org/terms/cultivationStatus"/><field index="50" term="http://rs.tdwg.org/dwc/terms/lifeStage"/><field index="51" term="http://rs.tdwg.org/dwc/terms/sex"/><field index="52" term="http://rs.tdwg.org/dwc/terms/individualCount"/><field index="53" term="http://rs.tdwg.org/dwc/terms/samplingProtocol"/><field index="54" term="http://rs.tdwg.org/dwc/terms/samplingEffort"/><field index="55" term="http://rs.tdwg.org/dwc/terms/preparations"/><field index="56" term="http://rs.tdwg.org/dwc/terms/country"/><field index="57" term="http://rs.tdwg.org/dwc/terms/stateProvince"/><field index="58" term="http://rs.tdwg.org/dwc/terms/county"/><field index="59" term="http://rs.tdwg.org/dwc/terms/municipality"/><field index="60" term="http://rs.tdwg.org/dwc/terms/locality"/><field index="61" term="http://rs.tdwg.org/dwc/terms/locationRemarks"/><field index="62" term="http://symbiota.org/terms/localitySecurity"/><field index="63" term="http://symbiota.org/terms/localitySecurityReason"/><field index="64" term="http://rs.tdwg.org/dwc/terms/decimalLatitude"/><field index="65" term="http://rs.tdwg.org/dwc/terms/decimalLongitude"/><field index="66" term="http://rs.tdwg.org/dwc/terms/geodeticDatum"/><field index="67" term="http://rs.tdwg.org/dwc/terms/coordinateUncertaintyInMeters"/><field index="68" term="http://rs.tdwg.org/dwc/terms/verbatimCoordinates"/><field index="69" term="http://rs.tdwg.org/dwc/terms/georeferencedBy"/><field index="70" term="http://rs.tdwg.org/dwc/terms/georeferenceProtocol"/><field index="71" term="http://rs.tdwg.org/dwc/terms/georeferenceSources"/><field index="72" term="http://rs.tdwg.org/dwc/terms/georeferenceVerificationStatus"/><field index="73" term="http://rs.tdwg.org/dwc/terms/georeferenceRemarks"/><field index="74" term="http://rs.tdwg.org/dwc/terms/minimumElevationInMeters"/><field index="75" term="http://rs.tdwg.org/dwc/terms/maximumElevationInMeters"/><field index="76" term="http://rs.tdwg.org/dwc/terms/minimumDepthInMeters"/><field index="77" term="http://rs.tdwg.org/dwc/terms/maximumDepthInMeters"/><field index="78" term="http://rs.tdwg.org/dwc/terms/verbatimDepth"/><field index="79" term="http://rs.tdwg.org/dwc/terms/verbatimElevation"/><field index="80" term="http://rs.tdwg.org/dwc/terms/disposition"/><field index="81" term="http://purl.org/dc/terms/language"/><field index="82" term="http://symbiota.org/terms/genericcolumn1"/><field index="83" term="http://symbiota.org/terms/genericcolumn2"/><field index="84" term="http://symbiota.org/terms/storageLocation"/><field index="85" term="http://symbiota.org/terms/observerUid"/><field index="86" term="http://symbiota.org/terms/processingStatus"/><field index="87" term="http://symbiota.org/terms/duplicateQuantity"/><field index="88" term="http://symbiota.org/terms/recordEnteredBy"/><field index="89" term="http://symbiota.org/terms/dateEntered"/><field index="90" term="http://rs.tdwg.org/dwc/terms/dateLastModified"/><field index="91" term="http://purl.org/dc/terms/modified"/><field index="92" term="http://symbiota.org/terms/sourcePrimaryKey-dbpk"/><field index="93" term="http://portal.idigbio.org/terms/recordId"/><field index="94" term="http://purl.org/dc/terms/references"/></core><extension encoding="UTF-8" fieldsTerminatedBy="," linesTerminatedBy="\n" fieldsEnclosedBy="&quot;" ignoreHeaderLines="1" rowType="http://rs.tdwg.org/dwc/terms/Identification"><files><location>identifications.csv</location></files><coreid index="0"/><field index="1" term="http://rs.tdwg.org/dwc/terms/identifiedBy"/><field index="2" term="http://symbiota.org/terms/identifiedByID"/><field index="3" term="http://rs.tdwg.org/dwc/terms/dateIdentified"/><field index="4" term="http://rs.tdwg.org/dwc/terms/identificationQualifier"/><field index="5" term="http://rs.tdwg.org/dwc/terms/scientificName"/><field index="6" term="http://symbiota.org/terms/tidInterpreted"/><field index="7" term="http://symbiota.org/terms/identificationIsCurrent"/><field index="8" term="http://rs.tdwg.org/dwc/terms/scientificNameAuthorship"/><field index="9" term="http://rs.tdwg.org/dwc/terms/genus"/><field index="10" term="http://rs.tdwg.org/dwc/terms/specificEpithet"/><field index="11" term="http://rs.tdwg.org/dwc/terms/taxonRank"/><field index="12" term="http://rs.tdwg.org/dwc/terms/infraspecificEpithet"/><field index="13" term="http://rs.tdwg.org/dwc/terms/identificationReferences"/><field index="14" term="http://rs.tdwg.org/dwc/terms/identificationRemarks"/><field index="15" term="http://portal.idigbio.org/terms/recordId"/><field index="16" term="http://purl.org/dc/terms/modified"/></extension><extension encoding="UTF-8" fieldsTerminatedBy="," linesTerminatedBy="\n" fieldsEnclosedBy="&quot;" ignoreHeaderLines="1" rowType="http://rs.gbif.org/terms/1.0/Image"><files><location>images.csv</location></files><coreid index="0"/><field index="1" term="http://purl.org/dc/terms/identifier"/><field index="2" term="http://rs.tdwg.org/ac/terms/accessURI"/><field index="3" term="http://rs.tdwg.org/ac/terms/thumbnailAccessURI"/><field index="4" term="http://rs.tdwg.org/ac/terms/goodQualityAccessURI"/><field index="5" term="http://purl.org/dc/terms/rights"/><field index="6" term="http://rs.tdwg.org/ac/terms/caption"/><field index="7" term="http://rs.tdwg.org/ac/terms/comments"/><field index="8" term="http://rs.tdwg.org/ac/terms/providerManagedID"/><field index="9" term="http://ns.adobe.com/xap/1.0/MetadataDate"/><field index="10" term="http://purl.org/dc/terms/format"/><field index="11" term="http://rs.tdwg.org/ac/terms/associatedSpecimenReference"/><field index="12" term="http://purl.org/dc/terms/type"/><field index="13" term="http://rs.tdwg.org/ac/terms/subtype"/><field index="14" term="http://rs.tdwg.org/ac/terms/metadataLanguage"/></extension><extension encoding="UTF-8" fieldsTerminatedBy="," linesTerminatedBy="\n" fieldsEnclosedBy="&quot;" ignoreHeaderLines="1" rowType="http://rs.iobis.org/obis/terms/ExtendedMeasurementOrFact"><files><location>measurementOrFact.csv</location></files><coreid index="0"/><field index="1" term="http://rs.tdwg.org/dwc/terms/measurementType"/><field index="2" term="http://rs.iobis.org/obis/terms/measurementTypeID"/><field index="3" term="http://rs.tdwg.org/dwc/terms/measurementValue"/><field index="4" term="http://rs.iobis.org/obis/terms/measurementValueID"/><field index="5" term="http://rs.tdwg.org/dwc/terms/measurementUnit"/><field index="6" term="http://rs.tdwg.org/dwc/terms/measurementDeterminedDate"/><field index="7" term="http://rs.tdwg.org/dwc/terms/measurementDeterminedBy"/><field index="8" term="http://rs.tdwg.org/dwc/terms/measurementRemarks"/></extension></archive>' . PHP_EOL;

//create a file handle to the meta.xml file as writable
$fhandle_meta=fopen($dwcameta, "w");
//write the two variables and close the file handle
fwrite($fhandle_meta,$meta1);
fwrite($fhandle_meta,$meta2);
fclose($fhandle_meta);

//define the root path to the files are located
//define the filename for the zip file
$dwcafn = "IDCdwca" . date('mdYHi')  . '.zip';
//define new zip archive
$zip = new ZipArchive();
//create the zip file and open it for writing
$zip -> open($dwcafn, ZipArchive::CREATE | ZipArchive::OVERWRITE);
//define the files to be added (no subfolders)
$files = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dwcarootPath), RecursiveIteratorIterator::LEAVES_ONLY);

//populate the zipfile with all files found in the folder
foreach ($files as $name => $file) {
	if (!$file ->isDir()) {
		$filePath = $file->getRealPath();
		$relativePath = substr($filePath, strlen($dwcarootPath) +1);
		$zip->addFile($filePath, $relativePath);
		}
}
//close the zip file
$zip -> close();
echo "<center>Finished!</center><br>";
echo "<center><strong>" . "<a href=\"$urlthree" . $dwcafn . "\">Click here to download</a></strong></center>";
ob_flush();
flush();
//display footer

include("footer.php");
?>